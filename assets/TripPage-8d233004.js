import{u as b,a,i as D,j as t,k as B,N as S,l as T,m as k,n as M,o as E,r as x,p as P,S as v,q as R,t as O,v as F}from"./index-4c59b009.js";import{T as f,I as $,a as q}from"./index-c6ac1b8b.js";import{I as j}from"./index-4940d321.js";const L=e=>e.modalReducer.isModalOpen,A=e=>e.modalReducer.date,G=e=>e.modalReducer.people,U=e=>e.tripByIdReducer.loading,N=e=>e.tripByIdReducer.trip,Y=()=>{const e=b(),n=a(A),o=a(G),{title:s,duration:r,level:d,price:c,id:l}=a(N),{id:u}=a(D),m=i=>{e(B(i.target.value))},g=i=>{const h=new Date,p=new Date(h);p.setDate(h.getDate()+1);const w=p.getFullYear(),_=String(p.getMonth()+1).padStart(2,"0"),I=String(p.getDate()).padStart(2,"0"),C=`${w}-${_}-${I}`;if(i.target.value<C)return S.Notify.warning("Please select valid date");e(T(i.target.value))},y=i=>{i.preventDefault(),e(k()),e(M({tripId:l,userId:u,guests:o,date:n})),e(E())};return t.jsxs("form",{onSubmit:y,className:"book-trip-popup__form",autoComplete:"off",children:[t.jsx(f,{title:s,prefix:"book-",duration:r,level:d,container:"popup"}),t.jsx(j,{heading:"Date",testId:"book-trip-popup-date",name:"date",type:"date",required:!0,value:n,onChange:g}),t.jsx(j,{heading:"Number of guests",testId:"book-trip-popup-guests",name:"guests",type:"number",required:!0,value:o,min:"1",max:"10",onChange:m}),t.jsxs("span",{className:"book-trip-popup__total",children:["Total:",t.jsxs("output",{"data-test-id":"book-trip-popup-total-value",className:"book-trip-popup__total-value",children:[Number(o)*c,"$"]})]}),t.jsx("button",{"data-test-id":"book-trip-popup-submit",className:"button",type:"submit",children:"Book a trip"})]})},z=document.querySelector("#modal-root"),H=()=>{const e=b(),{loading:n}=a(s=>s.tripByIdReducer),o=x.useCallback(()=>{e(k())},[e]);return x.useEffect(()=>{const s=r=>{r.code==="Escape"&&o()};return document.body.style.overflow="hidden",window.addEventListener("keydown",s),()=>{document.body.style.overflow="unset",window.removeEventListener("keydown",s)}},[o]),P.createPortal(t.jsx("div",{children:t.jsx("div",{className:"modal",children:t.jsxs("div",{"data-test-id":"book-trip-popup",className:"book-trip-popup",children:[t.jsx("button",{onClick:o,"data-test-id":"book-trip-popup-close",className:"book-trip-popup__close",children:"Ã—"}),n?t.jsx(v,{}):t.jsx(Y,{})]})})}),z)},V=()=>{const e=b(),{tripId:n}=R(),o=a(L),s=a(U),{title:r,duration:d,level:c,price:l,description:u,image:m}=a(N),g=()=>{e(F())};return x.useEffect(()=>{e(O(n))},[e,n]),t.jsxs("main",{className:"trip-page",children:[t.jsx("h1",{className:"visually-hidden",children:"Travel App"}),s?t.jsx(v,{}):t.jsxs("div",{className:"trip",children:[t.jsx($,{className:"trip__img","data-test-id":"trip-details-image",src:m,alt:`${r} photo`}),t.jsxs("div",{className:"trip__content",children:[t.jsx(f,{title:r,duration:d,level:c,container:"details"}),t.jsx("div",{"data-test-id":"trip-details-description",className:"trip__description",children:u}),t.jsx(q,{price:l,container:"details"}),t.jsx("button",{onClick:g,"data-test-id":"trip-details-button",className:"trip__button button",children:"Book a trip"})]})]}),o&&t.jsx(H,{})]})};export{V as default};
